generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id                       BigInt         @id @default(autoincrement()) @db.UnsignedBigInt
  name                     String         @db.VarChar(100)
  email                    String         @unique(map: "users_email_unique") @db.VarChar(100)
  password                 String         @db.VarChar(255)
  job_title                String?        @db.VarChar(100)
  estimated_monthly_income Decimal?       @default(0.00) @db.Decimal(15, 2)
  photos                   String?        @db.Text
  created_at               DateTime?      @default(now()) @db.Timestamp(0)
  updated_at               DateTime?      @default(now()) @updatedAt @db.Timestamp(0)
  categories               categories[]
  transactions             transactions[]
  wallets                  wallets[]

  @@map("users")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model categories {
  id           BigInt          @id @default(autoincrement()) @db.UnsignedBigInt
  user_id      BigInt          @db.UnsignedBigInt
  name         String          @db.VarChar(50)
  type         categories_type
  created_at   DateTime?       @default(now()) @db.Timestamp(0)
  updated_at   DateTime?       @default(now()) @db.Timestamp(0)
  users        User            @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "categories_user_id_foreign")
  transactions transactions[]

  @@index([user_id], map: "categories_user_id_foreign")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model transactions {
  id               BigInt            @id @default(autoincrement()) @db.UnsignedBigInt
  user_id          BigInt            @db.UnsignedBigInt
  wallet_id        BigInt            @db.UnsignedBigInt
  category_id      BigInt            @db.UnsignedBigInt
  type             transactions_type
  amount           Decimal           @db.Decimal(15, 2)
  transaction_date DateTime          @db.Date
  description      String?           @db.VarChar(255)
  created_at       DateTime?         @default(now()) @db.Timestamp(0)
  updated_at       DateTime?         @default(now()) @db.Timestamp(0)
  categories       categories        @relation(fields: [category_id], references: [id], onUpdate: Restrict, map: "transactions_category_id_foreign")
  users            User              @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "transactions_user_id_foreign")
  wallets          wallets           @relation(fields: [wallet_id], references: [id], onUpdate: Restrict, map: "transactions_wallet_id_foreign")

  @@index([user_id, transaction_date], map: "idx_user_date")
  @@index([category_id], map: "transactions_category_id_foreign")
  @@index([wallet_id], map: "transactions_wallet_id_foreign")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model wallets {
  id           BigInt         @id @default(autoincrement()) @db.UnsignedBigInt
  user_id      BigInt         @db.UnsignedBigInt
  name         String         @db.VarChar(50)
  type         wallets_type   @default(cash)
  balance      Decimal        @default(0.00) @db.Decimal(15, 2)
  is_active    Boolean        @default(true)
  created_at   DateTime?      @default(now()) @db.Timestamp(0)
  updated_at   DateTime?      @default(now()) @db.Timestamp(0)
  transactions transactions[]
  users        User           @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "wallets_user_id_foreign")

  @@index([user_id], map: "wallets_user_id_foreign")
}

enum categories_type {
  expense
  income
}

enum wallets_type {
  bank
  ewallet
  cash
  other
}

enum transactions_type {
  expense
  income
}
