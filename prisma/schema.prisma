generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id                       BigInt         @id @default(autoincrement())
  name                     String
  email                    String         @unique(map: "users_email_unique")
  password                 String
  job_title                String?
  estimated_monthly_income Decimal?       @default(0.00)
  photos                   String?
  created_at               DateTime?      @default(now())
  updated_at               DateTime?      @default(now()) @updatedAt
  categories               categories[]
  transactions             transactions[]
  wallets                  wallets[]

  @@map("users")
}

model categories {
  id           BigInt          @id @default(autoincrement())
  user_id      BigInt
  name         String
  type         categories_type
  created_at   DateTime?       @default(now())
  updated_at   DateTime?       @default(now())
  users        User            @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "categories_user_id_foreign")
  transactions transactions[]

  @@index([user_id], map: "categories_user_id_idx")
}

model transactions {
  id               BigInt            @id @default(autoincrement())
  user_id          BigInt
  wallet_id        BigInt
  category_id      BigInt
  type             transactions_type
  amount           Decimal
  transaction_date DateTime
  description      String?
  created_at       DateTime?         @default(now())
  updated_at       DateTime?         @default(now())
  categories       categories        @relation(fields: [category_id], references: [id], onUpdate: Restrict, map: "transactions_category_id_foreign")
  users            User              @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "transactions_user_id_foreign")
  wallets          wallets           @relation(fields: [wallet_id], references: [id], onUpdate: Restrict, map: "transactions_wallet_id_foreign")

  @@index([user_id, transaction_date], map: "idx_user_date")
  @@index([category_id], map: "transactions_category_id_idx")
  @@index([wallet_id], map: "transactions_wallet_id_idx")
}

model wallets {
  id           BigInt         @id @default(autoincrement())
  user_id      BigInt
  name         String
  type         wallets_type   @default(cash)
  balance      Decimal        @default(0.00)
  is_active    Boolean        @default(true)
  created_at   DateTime?      @default(now())
  updated_at   DateTime?      @default(now())
  transactions transactions[]
  users        User           @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "wallets_user_id_foreign")

  @@index([user_id], map: "wallets_user_id_idx")
}

enum categories_type {
  expense
  income
}

enum wallets_type {
  bank
  ewallet
  cash
  other
}

enum transactions_type {
  expense
  income
}
